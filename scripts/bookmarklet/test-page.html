<!DOCTYPE html>
<html>
<head>
    <title>Bookmarklet Tester</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 50px auto;
            padding: 20px;
        }
        .code-box {
            background: #f5f5f5;
            border: 2px solid #ddd;
            border-radius: 5px;
            padding: 15px;
            margin: 20px 0;
            word-wrap: break-word;
            font-family: monospace;
            font-size: 12px;
        }
        button {
            background: #0066cc;
            color: white;
            border: none;
            padding: 10px 20px;
            font-size: 16px;
            cursor: pointer;
            border-radius: 5px;
            margin: 10px 5px;
        }
        button:hover {
            background: #0052a3;
        }
        .success {
            color: green;
            font-weight: bold;
        }
        .error {
            color: red;
            font-weight: bold;
        }
        #result {
            margin-top: 20px;
            padding: 15px;
            border-radius: 5px;
        }
    </style>
</head>
<body>
    <h1>Bookmarklet Code Tester</h1>

    <h2>Step 1: Copy This Code</h2>
    <div class="code-box" id="bookmarkletCode">
javascript:(function(){try{const d={url:window.location.href,platform:'LinkedIn',timestamp:new Date().toISOString()};const t=document.querySelector('.job-details-jobs-unified-top-card__job-title, .jobs-unified-top-card__job-title, h1');d.title=t?t.textContent.trim():'Unknown Title';const c=document.querySelector('.job-details-jobs-unified-top-card__company-name, .jobs-unified-top-card__company-name, .jobs-unified-top-card__subtitle-primary-grouping a');d.company=c?c.textContent.trim():'Unknown Company';const l=document.querySelector('.job-details-jobs-unified-top-card__bullet, .jobs-unified-top-card__bullet');d.location=l?l.textContent.trim():'Unknown Location';const desc=document.querySelector('.jobs-description__content, .jobs-box__html-content, .description__text');d.description=desc?desc.innerText.trim():'No description';const meta=document.querySelectorAll('.jobs-unified-top-card__job-insight span');d.metadata=Array.from(meta).map(e=>e.textContent.trim()).join(' | ');const md='# '+d.title+'\n\n**Company:** '+d.company+'\n**Location:** '+d.location+'\n**Source:** ['+d.platform+']('+d.url+')\n**Saved:** '+new Date(d.timestamp).toLocaleString()+'\n\n'+(d.metadata?'**Additional Info:** '+d.metadata+'\n':'')+'---\n\n## Job Description\n\n'+d.description+'\n\n---\n\n**URL:** '+d.url+'\n';const fname=((s)=>s.replace(/[^a-zA-Z0-9\s]/g,'').replace(/\s+/g,'-').substring(0,50));const fn=fname(d.company)+'-'+fname(d.title)+'.md';const blob=new Blob([md],{type:'text/markdown'});const url=URL.createObjectURL(blob);const a=document.createElement('a');a.href=url;a.download=fn;document.body.appendChild(a);a.click();document.body.removeChild(a);URL.revokeObjectURL(url);alert('Job saved!\n\nCompany: '+d.company+'\nRole: '+d.title+'\n\nFile: '+fn+'\n\nMove to: staging/manual-saves/')}catch(e){alert('Error: '+e.message);console.error(e)}})();
    </div>

    <button onclick="copyCode()">Copy Code to Clipboard</button>

    <h2>Step 2: Test Syntax</h2>
    <button onclick="testSyntax()">Test JavaScript Syntax</button>

    <div id="result"></div>

    <h2>Step 3: Create Bookmark</h2>
    <ol>
        <li>Click "Copy Code to Clipboard" above</li>
        <li>Press Ctrl+Shift+B to show bookmarks bar</li>
        <li>Right-click bookmarks bar → "Add page..."</li>
        <li>Name: "Save Job"</li>
        <li>URL: Paste the code you just copied</li>
        <li>Save</li>
    </ol>

    <script>
        function copyCode() {
            const code = document.getElementById('bookmarkletCode').textContent;
            navigator.clipboard.writeText(code).then(() => {
                document.getElementById('result').innerHTML = '<div class="success">✅ Code copied to clipboard! Now create a bookmark with this code.</div>';
            }).catch(err => {
                document.getElementById('result').innerHTML = '<div class="error">❌ Copy failed: ' + err + '</div>';
            });
        }

        function testSyntax() {
            const code = document.getElementById('bookmarkletCode').textContent;
            const cleanCode = code.replace('javascript:', '');

            try {
                // Test if code is valid JavaScript
                new Function(cleanCode);
                document.getElementById('result').innerHTML = '<div class="success">✅ Syntax is valid! Code is ready to use.</div>';
            } catch (e) {
                document.getElementById('result').innerHTML = '<div class="error">❌ Syntax error: ' + e.message + '</div>';
            }
        }
    </script>
</body>
</html>
